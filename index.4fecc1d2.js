var t={};class e{static Status={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.state=t.concat(),this.status=e.Status.idle,this.score=0,this.initialState=t.concat()}getScore(){return this.score}getState(){return this.state}getStatus(){return this.updateStatus(),this.status}start(){this.status=e.Status.playing,this.state=this.initialState.concat(),this.createRandomTile(),this.createRandomTile(),this.printTiles()}restart(){this.clearTheBoard(),this.printTiles(),this.status=e.Status.idle,this.score=0}moveRight(){if(this.status!==e.Status.playing)return;let t=!1;for(let e=0;e<4;e++){let s=!1;for(let i=2;i>=0;i--)if(this.state[e][i]>0){let a=0,r=!1;for(;0===this.state[e][i+a+1];)a++;if(s||this.state[e][i+a+1]!==this.state[e][i]||(a++,r=!0),a>0){if(!s&&r){s=!0;let t=2*this.state[e][i+a];this.state[e][i+a]=t,this.score+=t}else s=!1,this.state[e][i+a]=this.state[e][i];this.state[e][i]=0,t=!0}}}return t&&this.createRandomTile(),t}moveLeft(){if(this.status!==e.Status.playing)return;let t=!1;for(let e=0;e<4;e++){let s=!1;for(let i=1;i<4;i++)if(this.state[e][i]>0){let a=0,r=!1;for(;0===this.state[e][i-a-1];)a++;if(s||this.state[e][i-a-1]!==this.state[e][i]||(a++,r=!0),a>0){if(!s&&r){s=!0;let t=2*this.state[e][i-a];this.state[e][i-a]=t,this.score+=t}else s=!1,this.state[e][i-a]=this.state[e][i];this.state[e][i]=0,t=!0}}}return t&&this.createRandomTile(),t}moveUp(){if(this.status!==e.Status.playing)return;let t=!1;for(let e=0;e<4;e++){let s=!1;for(let i=1;i<4;i++)if(this.state[i][e]>0){let a=0,r=!1;for(;i-a-1>=0&&0===this.state[i-a-1][e];)a++;if(!s&&i-a-1>=0&&this.state[i-a-1][e]===this.state[i][e]&&(a++,r=!0),a>0){if(!s&&r){s=!0;let t=2*this.state[i-a][e];this.state[i-a][e]=t,this.score+=t}else s=!1,this.state[i-a][e]=this.state[i][e];this.state[i][e]=0,t=!0}}}return t&&this.createRandomTile(),t}moveDown(){if(this.status!==e.Status.playing)return;let t=!1;for(let e=0;e<4;e++){let s=!1;for(let i=2;i>=0;i--)if(this.state[i][e]>0){let a=0,r=!1;for(;i+a+1<this.state.length&&0===this.state[i+a+1][e];)a++;if(!s&&i+a+1<this.state.length&&this.state[i+a+1][e]===this.state[i][e]&&(a++,r=!0),a>0){if(!s&&r){s=!0;let t=2*this.state[i+a][e];this.state[i+a][e]=t,this.score+=t}else s=!1,this.state[i+a][e]=this.state[i][e];this.state[i][e]=0,t=!0}}}return t&&this.createRandomTile(),t}isPlaying(){return this.getStatus()===e.Status.playing}createRandomTile(){let t=this.randomNumber(3);for(;!this.state[t].includes(0);)t=this.randomNumber(3);let e=this.randomNumber(3);for(;0!==this.state[t][e];)e=this.randomNumber(3);let s=this.state.map(t=>t.slice());s[t][e]=this.generateCellValue(),this.state=s,this.printTiles()}randomNumber(t){return Math.round(Math.random()*t)}generateCellValue(){return Math.random()>.9?4:2}updateStatus(){this.didPlayerWin()?this.status=e.Status.win:this.didPlayerLose()&&(this.status=e.Status.lose)}didPlayerWin(){for(let t of this.state.flat())if(2048===t)return!0;return!1}didPlayerLose(){for(let t of this.state.flat())if(0===t)return!1;for(let t=0;t<=3;t++)for(let e=0;e<=2;e++)if(this.state[t][e]===this.state[t][e+1])return!1;for(let t=0;t<=3;t++)for(let e=0;e<=2;e++)if(this.state[e][t]===this.state[e+1][t])return!1;return!0}printTiles(){let t=document.getElementsByClassName("field-cell"),e=this.state.flat();for(let s=0;s<e.length;s++){let i=t[s],a=e[s];a>0?void 0!==i&&(i.textContent=a,i.className=`field-cell field-cell--${a}`):void 0!==i&&(i.textContent="",i.className="field-cell")}}clearTheBoard(){this.state=this.initialState.concat()}}const s=new(t=e),i=document.querySelector(".start"),a=document.querySelector(".game-score"),r=document.querySelector(".message-lose"),l=document.querySelector(".message-win"),n=document.querySelector(".message-start");function h(e){e.preventDefault();let i=!1;switch(e.key){case"ArrowUp":i=s.moveUp();break;case"ArrowDown":i=s.moveDown();break;case"ArrowRight":i=s.moveRight();break;case"ArrowLeft":i=s.moveLeft()}if(i){var n;n=s.getScore(),a.textContent=n;let e=s.getStatus();e===t.Status.lose?r.classList.remove("hidden"):e===t.Status.win&&l.classList.remove("hidden")}}i.addEventListener("click",()=>{i.classList.contains("start")?(i.className="button restart",i.textContent="Restart",n.classList.add("hidden"),s.start()):(i.className="button start",i.textContent="Start",n.classList.remove("hidden"),l.classList.add("hidden"),r.classList.add("hidden"),document.removeEventListener("keydown",h),s.restart()),document.addEventListener("keydown",h)});
//# sourceMappingURL=index.4fecc1d2.js.map
